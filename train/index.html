<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astral Express - Welcome</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/welcome.css">
    <link rel="stylesheet" href="css/main-menu.css">
    <link rel="stylesheet" href="css/planet-selection.css">
    <link rel="stylesheet" href="css/belobog.css">
    <link rel="stylesheet" href="css/xianzhou.css">
    <link rel="stylesheet" href="css/penacony.css">
    <link rel="stylesheet" href="css/jarilo.css">
    <link rel="stylesheet" href="css/herta.css">
    <link rel="stylesheet" href="css/luofu.css">
    <link rel="stylesheet" href="css/stellaron.css">
    <link rel="stylesheet" href="css/terminus.css">
    <link rel="stylesheet" href="css/ui.css">
</head>
<body>
    <!-- Floating Stars Background (everywhere) -->
    <div id="floating-stars" class="floating-stars-container">
        <!-- Stars generated by JavaScript -->
    </div>

    <!-- Mute Toggle (always visible) -->
    <button id="mute-toggle" class="mute-toggle" aria-label="Toggle sound">
        <span class="mute-icon">üîä</span>
    </button>

    <!-- Settings Button (always visible) -->
    <button class="settings-trigger" onclick="openSettings()" aria-label="Open settings">
        ‚öôÔ∏è
    </button>



    <div id="welcome-screen" class="welcome-container">
        <div class="welcome-glow"></div>
        <h1 class="welcome-title">Welcome to the Astral Express</h1>
        <p class="welcome-text">Enter the password to board the train:</p>
        <div class="input-container">
            <input type="password" id="password-input" placeholder="Enter password" class="password-input">
            <button id="submit-btn" class="submit-btn">Board Train</button>
        </div>
        <p id="message" class="message"></p>
        <p id="hint" class="hint" style="display: none;">Hint: It's a loving message to someone special.</p>
    </div>

    <div id="loading-screen" class="loading-container" style="display: none;">
    <svg width="100%" height="100%" viewBox="0 0 1600 900" class="full-screen-train" preserveAspectRatio="xMidYMid slice">
        <defs>
                        <radialGradient id="milkyWayCore" cx="50%" cy="50%" r="60%">
                <stop offset="0%" stop-color="#1a1a3e" />
                <stop offset="30%" stop-color="#0f0f2e" />
                <stop offset="70%" stop-color="#050515" />
                <stop offset="100%" stop-color="#000005" />
            </radialGradient>
            
            <!-- Galaxy dust bands -->
            <linearGradient id="galaxyDust" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="rgba(138, 43, 226, 0.3)" />
                <stop offset="25%" stop-color="rgba(255, 105, 180, 0.4)" />
                <stop offset="50%" stop-color="rgba(255, 215, 0, 0.3)" />
                <stop offset="75%" stop-color="rgba(100, 149, 237, 0.4)" />
                <stop offset="100%" stop-color="rgba(138, 43, 226, 0.3)" />
            </linearGradient>
            
            <!-- Nebula clouds -->
            <radialGradient id="nebulaPurple" cx="30%" cy="40%">
                <stop offset="0%" stop-color="rgba(147, 51, 234, 0.6)" />
                <stop offset="50%" stop-color="rgba(126, 34, 206, 0.3)" />
                <stop offset="100%" stop-color="transparent" />
            </radialGradient>
            
            <radialGradient id="nebulaPink" cx="70%" cy="60%">
                <stop offset="0%" stop-color="rgba(236, 72, 153, 0.5)" />
                <stop offset="50%" stop-color="rgba(219, 39, 119, 0.2)" />
                <stop offset="100%" stop-color="transparent" />
            </radialGradient>
            
            <radialGradient id="nebulaBlue" cx="50%" cy="20%">
                <stop offset="0%" stop-color="rgba(59, 130, 246, 0.4)" />
                <stop offset="50%" stop-color="rgba(37, 99, 235, 0.2)" />
                <stop offset="100%" stop-color="transparent" />
            </radialGradient>
            
            <!-- Train gradient -->
            <linearGradient id="trainGlow" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stop-color="#ffd700" />
                <stop offset="50%" stop-color="#ff6b9d" />
                <stop offset="100%" stop-color="#c084fc" />
            </linearGradient>
            
            <!-- Star glow filter -->
            <filter id="starGlow">
                <feGaussianBlur stdDeviation="2" result="blur"/>
                <feMerge>
                    <feMergeNode in="blur"/>
                    <feMergeNode in="SourceGraphic"/>
                </feMerge>
            </filter>
            
            <!-- Train glow -->
            <filter id="trainGlow">
                <feGaussianBlur stdDeviation="4" result="blur"/>
                <feMerge>
                    <feMergeNode in="blur"/>
                    <feMergeNode in="SourceGraphic"/>
                </feMerge>
            </filter>
        </defs>
        
        <!-- Deep space background -->
        <rect width="1600" height="900" fill="url(#milkyWayCore)"/>
        
                <ellipse cx="800" cy="450" rx="900" ry="250" fill="url(#galaxyDust)" opacity="0.6" transform="rotate(-25 800 450)">
            <animate attributeName="opacity" values="0.5;0.7;0.5" dur="8s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Nebula clouds -->
        <ellipse cx="400" cy="300" rx="300" ry="200" fill="url(#nebulaPurple)" opacity="0.7">
            <animate attributeName="opacity" values="0.5;0.8;0.5" dur="6s" repeatCount="indefinite"/>
        </ellipse>
        <ellipse cx="1200" cy="600" rx="350" ry="220" fill="url(#nebulaPink)" opacity="0.6">
            <animate attributeName="opacity" values="0.4;0.7;0.4" dur="7s" repeatCount="indefinite"/>
        </ellipse>
        <ellipse cx="800" cy="200" rx="280" ry="180" fill="url(#nebulaBlue)" opacity="0.5">
            <animate attributeName="opacity" values="0.3;0.6;0.3" dur="5s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Star field (hundreds of stars) -->
        <g filter="url(#starGlow)">
            <!-- Large bright stars -->
            <circle cx="150" cy="100" r="3" fill="#ffffff" opacity="0.9">
                <animate attributeName="opacity" values="0.7;1;0.7" dur="2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="1400" cy="150" r="2.5" fill="#ffd700" opacity="0.8">
                <animate attributeName="opacity" values="0.6;1;0.6" dur="2.5s" repeatCount="indefinite"/>
            </circle>
            <circle cx="300" cy="700" r="2.5" fill="#c084fc" opacity="0.85">
                <animate attributeName="opacity" values="0.7;1;0.7" dur="1.8s" repeatCount="indefinite"/>
            </circle>
            <circle cx="1300" cy="750" r="3" fill="#ff6b9d" opacity="0.9">
                <animate attributeName="opacity" values="0.8;1;0.8" dur="2.2s" repeatCount="indefinite"/>
            </circle>
            
            <!-- Medium stars scattered across -->
            <circle cx="200" cy="250" r="2" fill="#ffffff" opacity="0.7"/>
            <circle cx="450" cy="180" r="1.5" fill="#ffffff" opacity="0.6"/>
            <circle cx="680" cy="120" r="2" fill="#ffffff" opacity="0.75"/>
            <circle cx="920" cy="200" r="1.5" fill="#ffffff" opacity="0.65"/>
            <circle cx="1150" cy="280" r="2" fill="#ffffff" opacity="0.7"/>
            <circle cx="1450" cy="350" r="1.5" fill="#ffffff" opacity="0.6"/>
            
            <circle cx="100" cy="450" r="1.5" fill="#ffffff" opacity="0.65"/>
            <circle cx="350" cy="520" r="2" fill="#ffffff" opacity="0.7"/>
            <circle cx="600" cy="480" r="1.5" fill="#ffffff" opacity="0.6"/>
            <circle cx="850" cy="550" r="2" fill="#ffffff" opacity="0.75"/>
            <circle cx="1100" cy="500" r="1.5" fill="#ffffff" opacity="0.65"/>
            <circle cx="1350" cy="580" r="2" fill="#ffffff" opacity="0.7"/>
            
            <circle cx="250" cy="650" r="1.5" fill="#ffffff" opacity="0.6"/>
            <circle cx="500" cy="720" r="2" fill="#ffffff" opacity="0.7"/>
            <circle cx="750" cy="680" r="1.5" fill="#ffffff" opacity="0.65"/>
            <circle cx="1000" cy="750" r="2" fill="#ffffff" opacity="0.75"/>
            <circle cx="1250" cy="680" r="1.5" fill="#ffffff" opacity="0.6"/>
            
            <!-- Small stars (dust) -->
            <circle cx="180" cy="320" r="1" fill="#ffffff" opacity="0.5"/>
            <circle cx="420" cy="280" r="1" fill="#ffffff" opacity="0.45"/>
            <circle cx="660" cy="240" r="1" fill="#ffffff" opacity="0.5"/>
            <circle cx="900" cy="310" r="1" fill="#ffffff" opacity="0.45"/>
            <circle cx="1140" cy="380" r="1" fill="#ffffff" opacity="0.5"/>
            <circle cx="1380" cy="420" r="1" fill="#ffffff" opacity="0.45"/>
            
            <!-- More small stars -->
            <circle cx="120" cy="550" r="1" fill="#ffffff" opacity="0.4"/>
            <circle cx="380" cy="600" r="1" fill="#ffffff" opacity="0.45"/>
            <circle cx="620" cy="580" r="1" fill="#ffffff" opacity="0.4"/>
            <circle cx="880" cy="640" r="1" fill="#ffffff" opacity="0.45"/>
            <circle cx="1120" cy="600" r="1" fill="#ffffff" opacity="0.4"/>
            <circle cx="1380" cy="660" r="1" fill="#ffffff" opacity="0.45"/>
        </g>
        
        <!-- Cosmic dust particles (moving) -->
        <g opacity="0.3">
            <circle cx="0" cy="200" r="1.5" fill="#ffd700">
                <animate attributeName="cx" values="-50;1650" dur="15s" repeatCount="indefinite"/>
            </circle>
            <circle cx="0" cy="400" r="1" fill="#c084fc">
                <animate attributeName="cx" values="-100;1700" dur="18s" repeatCount="indefinite"/>
            </circle>
            <circle cx="0" cy="600" r="1.5" fill="#ff6b9d">
                <animate attributeName="cx" values="-80;1680" dur="20s" repeatCount="indefinite"/>
            </circle>
            <circle cx="0" cy="300" r="1" fill="#ffffff">
                <animate attributeName="cx" values="-120;1720" dur="16s" repeatCount="indefinite"/>
            </circle>
            <circle cx="0" cy="700" r="1.5" fill="#ffd700">
                <animate attributeName="cx" values="-60;1660" dur="19s" repeatCount="indefinite"/>
            </circle>
        </g>
        
        <!-- The Astral Express train (sleek, glowing) -->
        <g filter="url(#trainGlow)">
            <!-- Train motion -->
            <g>
                <animateTransform 
                    attributeName="transform" 
                    type="translate"
                    values="-400,0; 2000,0" 
                    dur="5s" 
                    repeatCount="indefinite"/>
                
                <!-- Train body -->
                <g>
                    <!-- Main cabin -->
                    <rect x="600" y="400" width="200" height="60" rx="10" fill="#1a1a3e" stroke="url(#trainGlow)" stroke-width="2"/>
                    
                    <!-- Windows -->
                    <rect x="620" y="415" width="35" height="25" rx="3" fill="#ffd700" opacity="0.8">
                        <animate attributeName="opacity" values="0.6;1;0.6" dur="1s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="665" y="415" width="35" height="25" rx="3" fill="#ffd700" opacity="0.8">
                        <animate attributeName="opacity" values="0.6;1;0.6" dur="1.2s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="710" y="415" width="35" height="25" rx="3" fill="#ffd700" opacity="0.8">
                        <animate attributeName="opacity" values="0.6;1;0.6" dur="0.9s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="755" y="415" width="35" height="25" rx="3" fill="#ffd700" opacity="0.8">
                        <animate attributeName="opacity" values="0.6;1;0.6" dur="1.1s" repeatCount="indefinite"/>
                    </rect>
                    
                    <!-- Front engine -->
                    <path d="M 800 410 L 850 420 L 850 440 L 800 450 Z" fill="#2a2a5e" stroke="#ffd700" stroke-width="2"/>
                    
                    <!-- Headlight -->
                    <circle cx="850" cy="430" r="8" fill="#ffd700" opacity="0.9">
                        <animate attributeName="opacity" values="0.7;1;0.7" dur="0.5s" repeatCount="indefinite"/>
                    </circle>
                    
                    <!-- Light beam -->
                    <polygon points="858,430 1000,425 1000,435 858,430" fill="#ffd700" opacity="0.3">
                        <animate attributeName="opacity" values="0.2;0.4;0.2" dur="0.5s" repeatCount="indefinite"/>
                    </polygon>
                    
                    <!-- Rear car -->
                    <rect x="400" y="405" width="200" height="50" rx="8" fill="#1a1a3e" stroke="url(#trainGlow)" stroke-width="2"/>
                    
                    <!-- Rear windows -->
                    <rect x="420" y="418" width="30" height="22" rx="3" fill="#c084fc" opacity="0.7">
                        <animate attributeName="opacity" values="0.5;0.9;0.5" dur="1.3s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="460" y="418" width="30" height="22" rx="3" fill="#c084fc" opacity="0.7">
                        <animate attributeName="opacity" values="0.5;0.9;0.5" dur="1.1s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="500" y="418" width="30" height="22" rx="3" fill="#c084fc" opacity="0.7">
                        <animate attributeName="opacity" values="0.5;0.9;0.5" dur="1.4s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="540" y="418" width="30" height="22" rx="3" fill="#c084fc" opacity="0.7">
                        <animate attributeName="opacity" values="0.5;0.9;0.5" dur="1.2s" repeatCount="indefinite"/>
                    </rect>
                    
                    <!-- Accent stripes -->
                    <rect x="410" y="435" width="180" height="3" fill="#ff6b9d" opacity="0.8"/>
                    <rect x="610" y="440" width="180" height="3" fill="#ff6b9d" opacity="0.8"/>
                    
                    <!-- Wheels (simple) -->
                    <circle cx="450" cy="460" r="8" fill="#333" stroke="#ffd700" stroke-width="1"/>
                    <circle cx="550" cy="460" r="8" fill="#333" stroke="#ffd700" stroke-width="1"/>
                    <circle cx="650" cy="465" r="8" fill="#333" stroke="#ffd700" stroke-width="1"/>
                    <circle cx="750" cy="465" r="8" fill="#333" stroke="#ffd700" stroke-width="1"/>
                </g>
            </g>
        </g>
        
        <!-- Title text -->
        <text x="800" y="150" text-anchor="middle" fill="#ffd700" font-size="56" font-family="Arial, sans-serif" font-weight="bold" filter="url(#starGlow)">
            Astral Express
            <animate attributeName="opacity" values="0.8;1;0.8" dur="2s" repeatCount="indefinite"/>
        </text>
        
        <text x="800" y="200" text-anchor="middle" fill="#c084fc" font-size="24" font-family="Arial, sans-serif" font-style="italic">
            Crossing the Milky Way...
            <animate attributeName="opacity" values="0.6;1;0.6" dur="3s" repeatCount="indefinite"/>
        </text>
        
        <!-- Loading dots -->
        <g>
            <circle cx="750" cy="750" r="5" fill="#ffd700">
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite"/>
            </circle>
            <circle cx="780" cy="750" r="5" fill="#ff6b9d">
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" begin="0.2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="810" cy="750" r="5" fill="#c084fc">
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" begin="0.4s" repeatCount="indefinite"/>
            </circle>
            <circle cx="840" cy="750" r="5" fill="#ffd700">
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" begin="0.6s" repeatCount="indefinite"/>
            </circle>
        </g>
    </svg>
</div>



    <!-- Main menu: train interior with navigation stands -->
    <div id="main-menu" class="main-menu" style="display: none;">
        <div class="train-interior">
            <!-- Windows and ambient details -->
            <div class="train-window-strip">
                <div class="window"><div class="stars-layer"></div></div>
                <div class="window"><div class="stars-layer"></div></div>
                <div class="window"><div class="stars-layer"></div></div>
            </div>

            <div class="ceiling-lights">
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
            </div>

            <div class="floor-gradient"></div>

            <!-- Navigation stands (Main Menu contents) -->
            <div id="map-stand" class="object-stand" data-tooltip="View route and destinations" data-target="map">
                <div class="stand-base"></div>
                <div class="stand-pole"></div>
                <div class="stand-screen stand-glow">
                    <div class="map-mini">
                        <div class="map-planet current"></div>
                        <div class="map-planet"></div>
                        <div class="map-planet"></div>
                        <div class="map-path"></div>
                    </div>
                    <div class="stand-label">Route Map</div>
                </div>
            </div>

            <div id="log-stand" class="object-stand" data-tooltip="Mission and travel logs" data-target="logs">
                <div class="stand-screen">
                    <div class="screen-lines">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <div class="stand-label">Mission Log</div>
                </div>
            </div>

           <div id="inv-stand" class="object-stand" data-tooltip="Inventory and gifts" data-target="inventory">
               <div class="stand-base"></div>
               <div class="stand-pole"></div>
               <div class="locker-body">
                   <div class="locker-door"></div>
                   <div class="locker-lights">
                       <span></span><span></span><span></span>
                   </div>
               </div>
               <div class="stand-label">Inventory</div>
           </div>

           <!-- Inventory overlay: shows your attuned ticket when Belobog trial is complete -->
           <div id="inventory-overlay" class="inventory-overlay" style="display: none;">
               <div class="inventory-panel">
                   <div class="inventory-header">
                       <div class="inventory-title">Astral Express Inventory</div>
                       <div class="inventory-subtitle">Personal artifacts and boarding passes</div>
                   </div>
                   <div class="inventory-body">
                       <div class="inventory-ticket-header">Next Planet Ticket</div>
                       <div id="inventory-xianzhou-card" class="inventory-ticket-card locked">
                           <div class="ticket-label">Xianzhou Luofu Boarding Pass</div>
                           <div class="ticket-world">Xianzhou Luofu</div>
                           <div class="ticket-note">
                               Locked ‚Äî Clear the Belobog Oath to attune this pass.
                           </div>
                       </div>
                   </div>
                   <button id="inventory-close-btn" class="inventory-close-btn">Close Inventory</button>
               </div>
           </div>


        </div>
    </div>

    <!-- Planet selection overlay (opens when using Route Map in Main Menu) -->
    <div id="planet-selection" class="planet-portal" style="display: none;">
        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <div class="celestial-row">

            <!-- Planets arranged in half-heart constellation -->
            <div class="celestial-orb planet-option unlocked" data-planet="belobog">
                <div class="orb-glow"></div>
                <span class="orb-label">Belobog</span>
            </div>
            <div class="celestial-orb planet-option locked" data-planet="xianzhou">
                <div class="orb-glow"></div>
                <span class="orb-label">Xianzhou Luofu</span>
            </div>
            <div class="celestial-orb planet-option locked" data-planet="penacony">
                <div class="orb-glow"></div>
                <span class="orb-label">Penacony</span>
            </div>
            <div class="celestial-orb planet-option locked" data-planet="jarilo">
                <div class="orb-glow"></div>
                <span class="orb-label">Jarilo-VI</span>
            </div>
            <div class="celestial-orb planet-option locked" data-planet="herta">
                <div class="orb-glow"></div>
                <span class="orb-label">Herta Station</span>
            </div>
            <div class="celestial-orb planet-option locked" data-planet="luofu">
                <div class="orb-glow"></div>
                <span class="orb-label">Luofu Sanctum</span>
            </div>
            <div class="celestial-orb planet-option locked" data-planet="stellaron">
                <div class="orb-glow"></div>
                <span class="orb-label">Stellaron</span>
            </div>
            <div class="celestial-orb planet-option locked" data-planet="terminus">
                <div class="orb-glow"></div>
                <span class="orb-label">Terminus</span>
            </div>
        </div>

        <div class="portal-ui">
            <button id="back-to-menu" class="portal-back-btn">Back to Main Menu</button>
            <div id="planet-label" class="mini-label">Select your destination.</div>
        </div>
    </div>

    <!-- Destination portal screen (Belobog = castle interior with celestial relics) -->
    <div id="destination-portal" class="planet-portal belobog-castle" style="display: none;">
        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <!-- Candy wonderland decorations -->
        <div class="castle-pillars">
            <div class="pillar"></div>
            <div class="pillar"></div>
            <div class="pillar"></div>
            <div class="pillar"></div>
        </div>
        <div class="castle-arch"></div>
        <div class="castle-emblem"></div>
        
        <!-- Falling chocolates -->
        <div class="falling-chocolates">
            <div class="chocolate">üç´</div>
            <div class="chocolate">üç´</div>
            <div class="chocolate">üç´</div>
            <div class="chocolate">üç´</div>
            <div class="chocolate">üç´</div>
            <div class="chocolate">üç´</div>
        </div>
        
        <!-- Floating clouds -->
        <div class="candy-clouds">
            <div class="cloud"></div>
            <div class="cloud"></div>
            <div class="cloud"></div>
            <div class="cloud"></div>
        </div>

        <!-- Three celestial content objects inside Belobog castle -->
        <div class="belobog-celestial-row">
            <!-- 1: Fill-in-the-blank mini-game trigger -->
            <div id="belobog-celestial-1" class="belobog-celestial" data-minigame="fill-blank">
                <div class="belobog-celestial-icon">üç≠</div>
                <div class="belobog-celestial-label">Sweet Oath</div>
                <div class="belobog-celestial-desc">
                    Complete the words that bind hearts across worlds.
                </div>
            </div>

            <!-- 2: Celestial object placeholder for future mini-game -->
            <div id="belobog-celestial-2" class="belobog-celestial" data-minigame="trial-2">
                <div class="belobog-celestial-icon">üç¨</div>
                <div class="belobog-celestial-label">Candy Seal</div>
                <div class="belobog-celestial-desc">
                    A sugary sigil waiting for your resolve.
                </div>
            </div>

            <!-- 3: Celestial object placeholder for future mini-game -->
            <div id="belobog-celestial-3" class="belobog-celestial" data-minigame="trial-3">
                <div class="belobog-celestial-icon">üç∞</div>
                <div class="belobog-celestial-label">Sweet Melody</div>
                <div class="belobog-celestial-desc">
                    The stars hum a secret hymn. (Mini-game WIP)
                </div>
            </div>
        </div>

        <!-- Fill-in-the-blank mini-game overlay (1st celestial object) -->
        <div id="belobog-fill-game" class="belobog-fill-container">
            <div class="belobog-fill-title">Belobog Oath ‚Äî Fill in the Blank</div>
            <div class="belobog-fill-layout">
                <!-- Left: options as context clues -->
                <div class="belobog-fill-options">
                    <div class="belobog-fill-options-title">Choose the right word:</div>
                    <button class="belobog-fill-option" data-word="light">light</button>
                    <button class="belobog-fill-option" data-word="queen">queen</button>
                    <button class="belobog-fill-option" data-word="angel">angel</button>
                </div>

                <!-- Right: sentence with explicit blank and input -->
                <div class="belobog-fill-right">
                    <div class="belobog-fill-prompt">
                        Within these castle walls, amid frost and fire, you whisper:<br/>
                        ‚ÄúYou are my <span class="belobog-fill-blank">______</span> among the stars.‚Äù
                    </div>
                    <input
                        id="belobog-fill-input"
                        class="belobog-fill-input"
                        type="text"
                        placeholder="Type or click an option on the left..."
                    />
                    <button id="belobog-fill-submit" class="belobog-fill-button">Lock In Oath</button>
                    <div id="belobog-fill-feedback" class="belobog-fill-feedback"></div>
                </div>
            </div>
        </div>

        <!-- Fill-in-the-blank mini-game 2 (Frostbound Seal) -->
        <div id="belobog-fill-game-2" class="belobog-fill-container">
            <div class="belobog-fill-title">Frostbound Seal ‚Äî Fill in the Blank</div>
            <div class="belobog-fill-layout">
                <div class="belobog-fill-options">
                    <div class="belobog-fill-options-title">Choose the right word:</div>
                    <button class="belobog-fill-option-2" data-word="warmth">warmth</button>
                    <button class="belobog-fill-option-2" data-word="strength">strength</button>
                    <button class="belobog-fill-option-2" data-word="hope">hope</button>
                </div>

                <div class="belobog-fill-right">
                    <div class="belobog-fill-prompt">
                        Through the frozen winds and endless night, I declare:<br/>
                        "Your presence is my <span class="belobog-fill-blank-2">______</span> in the cold."
                    </div>
                    <input
                        id="belobog-fill-input-2"
                        class="belobog-fill-input"
                        type="text"
                        placeholder="Type or click an option on the left..."
                    />
                    <button id="belobog-fill-submit-2" class="belobog-fill-button">Lock In Seal</button>
                    <div id="belobog-fill-feedback-2" class="belobog-fill-feedback"></div>
                </div>
            </div>
        </div>

        <!-- Fill-in-the-blank mini-game 3 (Stellar Choir) -->
        <div id="belobog-fill-game-3" class="belobog-fill-container">
            <div class="belobog-fill-title">Stellar Choir ‚Äî Fill in the Blank</div>
            <div class="belobog-fill-layout">
                <div class="belobog-fill-options">
                    <div class="belobog-fill-options-title">Choose the right word:</div>
                    <button class="belobog-fill-option-3" data-word="forever">forever</button>
                    <button class="belobog-fill-option-3" data-word="always">always</button>
                    <button class="belobog-fill-option-3" data-word="eternally">eternally</button>
                </div>

                <div class="belobog-fill-right">
                    <div class="belobog-fill-prompt">
                        As the stars sing their ancient hymn, I vow:<br/>
                        "I will love you <span class="belobog-fill-blank-3">______</span>, across all worlds."
                    </div>
                    <input
                        id="belobog-fill-input-3"
                        class="belobog-fill-input"
                        type="text"
                        placeholder="Type or click an option on the left..."
                    />
                    <button id="belobog-fill-submit-3" class="belobog-fill-button">Lock In Vow</button>
                    <div id="belobog-fill-feedback-3" class="belobog-fill-feedback"></div>
                </div>
            </div>
        </div>

        <!-- Belobog mission status window: collapsible dropdown for organized status -->
        <div id="belobog-mission-panel" class="belobog-mission-panel">
            <button id="belobog-mission-toggle" class="mission-toggle">
                <span class="mission-toggle-label">Belobog Mission & Ticket Status</span>
                <span id="belobog-mission-pill" class="mission-pill mission-pill-pending">Incomplete</span>
                <span class="mission-toggle-icon">‚åµ</span>
            </button>
            <div id="belobog-mission-content" class="mission-content">
                <div class="mission-section">
                    <div class="mission-section-title">World Brief</div>
                    <div class="mission-line">
                        <span class="label">Current World</span>
                        <span class="value">Belobog ‚Äî Castle Hall</span>
                    </div>
                    <div class="mission-line">
                        <span class="label">Main Trial</span>
                        <span class="value">Belobog Oath ‚Äî Fill in the Blank</span>
                    </div>
                    <div class="mission-line">
                        <span class="label">Status</span>
                        <span id="belobog-mission-status" class="value status-pending">
                            Incomplete ‚Äî Clear the Oath Script relic.
                        </span>
                    </div>
                </div>

                <div class="mission-section">
                    <div class="mission-section-title">Ticket Requirements</div>
                    <ul class="mission-list">
                        <li>Complete the Belobog Oath Script with the true word.</li>
                        <li>Illuminate the castle seal to prove your resolve.</li>
                    </ul>
                </div>

                <div class="mission-section">
                    <div class="mission-section-title">Next Planet Ticket</div>
                    <div class="ticket-preview">
                        <div class="ticket-label">Xianzhou Luofu Boarding Pass</div>
                        <div class="ticket-card locked">
                            <div class="ticket-world">Xianzhou Luofu</div>
                            <div class="ticket-note">Locked ‚Äî Finish Belobog mission to attune this ticket.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="portal-ui">
            <button id="back-to-planets" class="portal-back-btn">Back to Planet Selection</button>
            <div id="destination-label" class="mini-label">Belobog Castle Portal initialized.</div>
        </div>

        <div class="belobog-minigame-placeholder">
            Choose a celestial relic. The first begins your oath with a fill-in-the-blank trial.
        </div>
    </div>

    <!-- Xianzhou Luofu portal (shattered mirror memories) -->
    <div id="xianzhou-portal" class="planet-portal xianzhou-mirror" style="display: none;">

        <!-- Back to planet selection: top-left revert icon -->
        <button id="xianzhou-back-planets" class="portal-back-icon" aria-label="Back to planet selection">
            ‚¨Ö
        </button>

        <!-- Dimmed core so it feels like the door frame for the mirror wall -->
        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <!-- Subtle mirror reflections -->
        <div class="mirror-reflections">
            <div class="mirror-frame"></div>
            <div class="mirror-frame"></div>
        </div>
        
        <!-- Drifting mist layers -->
        <div class="ethereal-mist">
            <div class="mist-layer"></div>
            <div class="mist-layer"></div>
            <div class="mist-layer"></div>
        </div>
        
        <!-- Shooting stars -->
        <div class="shooting-stars">
            <div class="shooting-star"></div>
            <div class="shooting-star"></div>
            <div class="shooting-star"></div>
        </div>
        
        <!-- Mystical floating particles -->
        <div class="mystical-particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>
        
        <!-- Constellation connections -->
        <svg class="constellation-lines" width="100%" height="100%">
            <line x1="20%" y1="15%" x2="45%" y2="12%" class="connection-line" />
            <line x1="45%" y1="12%" x2="72%" y2="16%" class="connection-line" />
            <line x1="35%" y1="40%" x2="52%" y2="48%" class="connection-line" />
            <line x1="52%" y1="48%" x2="68%" y2="42%" class="connection-line" />
            <line x1="15%" y1="62%" x2="38%" y2="66%" class="connection-line" />
            <line x1="38%" y1="66%" x2="70%" y2="64%" class="connection-line" />
            <line x1="25%" y1="82%" x2="58%" y2="79%" class="connection-line" />
        </svg>
        
        <!-- Glass shard field -->
        <div class="xianzhou-glass-layer">
            <div class="glass-shard" data-memory="I love being with you."></div>
            <div class="glass-shard" data-memory="You make every station feel like home."></div>
            <div class="glass-shard" data-memory="Your laughter is my favorite signal."></div>
            <div class="glass-shard" data-memory="I‚Äôd reroute the Astral Express just to see you smile."></div>
            <div class="glass-shard" data-memory="Holding your hand feels like a perfect timeline."></div>
            <div class="glass-shard" data-memory="Every goodbye is only a countdown to our next hello."></div>
            <div class="glass-shard" data-memory="You are my safe carriage in every storm."></div>
            <div class="glass-shard" data-memory="I choose you in every universe."></div>

            <!-- More generic shards to make the mirror feel shattered -->
            <div class="glass-shard" data-memory="You are the warmth between cold stars."></div>
            <div class="glass-shard" data-memory="You‚Äôre the soft pause between my battles."></div>
            <div class="glass-shard" data-memory="You are my favorite anomaly."></div>
            <div class="glass-shard" data-memory="With you, time feels infinite."></div>
            <div class="glass-shard" data-memory="Your smile is my constellation."></div>
            <div class="glass-shard" data-memory="You are my anchor in the void."></div>
            <div id="xianzhou-red-shard" class="glass-shard red-shard" data-memory=""></div>
        </div>

        <!-- Portal UI for Xianzhou -->
        <div class="portal-ui xianzhou-ui">
            <div id="xianzhou-label" class="mini-label">
                Shattered reflections of us ‚Äî each shard holds a quiet memory.
            </div>
        </div>
    </div>

    <!-- Jarilo-VI portal (frozen world) -->
    <div id="jarilo-portal" class="planet-portal jarilo-frozen" style="display: none;">
        <button id="jarilo-back-planets" class="portal-back-icon" aria-label="Back to planet selection">
            ‚¨Ö
        </button>

        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <!-- Icebergs on sides -->
        <div class="icebergs">
            <div class="iceberg left-near"></div>
            <div class="iceberg left-far"></div>
            <div class="iceberg right-near"></div>
            <div class="iceberg right-far"></div>
        </div>

        <!-- Enhanced ice fog -->
        <div class="ice-fog">
            <div class="fog-layer"></div>
            <div class="fog-layer"></div>
            <div class="fog-layer"></div>
            <div class="fog-layer"></div>
        </div>

        <!-- Floating ice crystals -->
        <div class="ice-crystals">
            <div class="ice-crystal">üíé</div>
            <div class="ice-crystal">üíé</div>
            <div class="ice-crystal">üíé</div>
            <div class="ice-crystal">üíé</div>
            <div class="ice-crystal">üíé</div>
            <div class="ice-crystal">üíé</div>
        </div>

        <!-- Frost particles -->
        <div class="frost-particles">
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
            <div class="frost-particle"></div>
        </div>

        <!-- Frozen landscape -->
        <div class="frozen-content">
            <div class="jarilo-title">Jarilo-VI - Frozen Memory</div>
            <div class="jarilo-message">
                Collect the frozen fragments to restore the memory.
            </div>

            <!-- Puzzle frame in center - 3x3 grid -->
            <div class="puzzle-frame">
                <div class="puzzle-grid-container">
                    <div class="puzzle-slot" data-position="1"></div>
                    <div class="puzzle-slot" data-position="2"></div>
                    <div class="puzzle-slot" data-position="3"></div>
                    <div class="puzzle-slot" data-position="4"></div>
                    <div class="puzzle-slot" data-position="5"></div>
                    <div class="puzzle-slot" data-position="6"></div>
                    <div class="puzzle-slot" data-position="7"></div>
                    <div class="puzzle-slot" data-position="8"></div>
                    <div class="puzzle-slot" data-position="9"></div>
                </div>
                <div class="puzzle-counter">
                    <span id="pieces-collected">0</span> / 9
                </div>
            </div>

            <!-- Scattered draggable puzzle pieces with Elysia image parts -->
            <div class="puzzle-piece" data-piece="1" data-position="1" draggable="true" style="top: 8%; left: 5%;"></div>
            <div class="puzzle-piece" data-piece="2" data-position="2" draggable="true" style="top: 12%; right: 7%;"></div>
            <div class="puzzle-piece" data-piece="3" data-position="3" draggable="true" style="top: 30%; left: 2%;"></div>
            <div class="puzzle-piece" data-piece="4" data-position="4" draggable="true" style="top: 38%; right: 4%;"></div>
            <div class="puzzle-piece" data-piece="5" data-position="5" draggable="true" style="top: 60%; left: 6%;"></div>
            <div class="puzzle-piece" data-piece="6" data-position="6" draggable="true" style="top: 68%; right: 8%;"></div>
            <div class="puzzle-piece" data-piece="7" data-position="7" draggable="true" style="bottom: 12%; left: 10%;"></div>
            <div class="puzzle-piece" data-piece="8" data-position="8" draggable="true" style="bottom: 8%; right: 12%;"></div>
            <div class="puzzle-piece" data-piece="9" data-position="9" draggable="true" style="top: 48%; left: 1%;"></div>

            <!-- Heavy snowfall -->
            <div class="snowflakes">
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
                <div class="snowflake small">‚ùÑ</div>
                <div class="snowflake">‚ùÑ</div>
                <div class="snowflake large">‚ùÑ</div>
            </div>
        </div>

        <div class="portal-ui">
            <div id="jarilo-label" class="mini-label">
                Welcome to the frozen world of Jarilo-VI.
            </div>
        </div>
    </div>

    <!-- Herta Station portal (tech/research facility) -->
    <div id="herta-portal" class="planet-portal herta-station" style="display: none;">
        <button id="herta-back-planets" class="portal-back-icon" aria-label="Back to planet selection">
            ‚¨Ö
        </button>

        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <!-- Floating holographic cubes -->
        <div class="holo-cubes">
            <div class="holo-cube" style="top: 15%; left: 10%;"></div>
            <div class="holo-cube" style="top: 25%; right: 15%;"></div>
            <div class="holo-cube" style="top: 60%; left: 8%;"></div>
            <div class="holo-cube" style="top: 70%; right: 12%;"></div>
            <div class="holo-cube" style="top: 40%; right: 8%;"></div>
            <div class="holo-cube" style="top: 50%; left: 12%;"></div>
        </div>

        <!-- Holographic screens with data -->
        <div class="holo-screens">
            <div class="holo-screen" style="top: 20%; left: 20%;">
                <div class="screen-data">
                    <div class="data-line">QUANTUM_STATE: ACTIVE</div>
                    <div class="data-line">PUPPET_SYNC: 98.7%</div>
                    <div class="data-line">DIMENSION_FLUX: STABLE</div>
                </div>
            </div>
            <div class="holo-screen" style="top: 55%; right: 18%;">
                <div class="screen-data">
                    <div class="data-line">RESEARCH_LOG: #4729</div>
                    <div class="data-line">ANOMALY_DETECTED: YES</div>
                    <div class="data-line">ANALYSIS: IN PROGRESS</div>
                </div>
            </div>
        </div>

        <!-- Mechanical puppet dolls -->
        <div class="mechanical-puppets">
            <div class="mech-puppet" style="top: 12%; left: 6%;">
                <div class="puppet-head">
                    <div class="puppet-eye left"></div>
                    <div class="puppet-eye right"></div>
                </div>
                <div class="puppet-body"></div>
                <div class="puppet-arm left"></div>
                <div class="puppet-arm right"></div>
                <div class="puppet-leg left"></div>
                <div class="puppet-leg right"></div>
                <div class="puppet-joint head-joint"></div>
                <div class="puppet-joint shoulder-left"></div>
                <div class="puppet-joint shoulder-right"></div>
                <div class="puppet-joint hip-left"></div>
                <div class="puppet-joint hip-right"></div>
            </div>
            <div class="mech-puppet" style="top: 35%; right: 10%;">
                <div class="puppet-head">
                    <div class="puppet-eye left"></div>
                    <div class="puppet-eye right"></div>
                </div>
                <div class="puppet-body"></div>
                <div class="puppet-arm left"></div>
                <div class="puppet-arm right"></div>
                <div class="puppet-leg left"></div>
                <div class="puppet-leg right"></div>
                <div class="puppet-joint head-joint"></div>
                <div class="puppet-joint shoulder-left"></div>
                <div class="puppet-joint shoulder-right"></div>
                <div class="puppet-joint hip-left"></div>
                <div class="puppet-joint hip-right"></div>
            </div>
            <div class="mech-puppet" style="bottom: 18%; left: 8%;">
                <div class="puppet-head">
                    <div class="puppet-eye left"></div>
                    <div class="puppet-eye right"></div>
                </div>
                <div class="puppet-body"></div>
                <div class="puppet-arm left"></div>
                <div class="puppet-arm right"></div>
                <div class="puppet-leg left"></div>
                <div class="puppet-leg right"></div>
                <div class="puppet-joint head-joint"></div>
                <div class="puppet-joint shoulder-left"></div>
                <div class="puppet-joint shoulder-right"></div>
                <div class="puppet-joint hip-left"></div>
                <div class="puppet-joint hip-right"></div>
            </div>
            <div class="mech-puppet" style="bottom: 28%; right: 12%;">
                <div class="puppet-head">
                    <div class="puppet-eye left"></div>
                    <div class="puppet-eye right"></div>
                </div>
                <div class="puppet-body"></div>
                <div class="puppet-arm left"></div>
                <div class="puppet-arm right"></div>
                <div class="puppet-leg left"></div>
                <div class="puppet-leg right"></div>
                <div class="puppet-joint head-joint"></div>
                <div class="puppet-joint shoulder-left"></div>
                <div class="puppet-joint shoulder-right"></div>
                <div class="puppet-joint hip-left"></div>
                <div class="puppet-joint hip-right"></div>
            </div>
        </div>

        <!-- Tech interface -->
        <div class="herta-content">
            <div class="herta-title">Herta Station</div>
            <div class="herta-subtitle">Dimensional Research Lab</div>

            <!-- Portal Button on Left -->
            <button id="dimension-portal-btn" class="dimension-portal-btn">
                <div class="portal-icon">üîç</div>
                <div class="portal-text">Find</div>
            </button>

            <!-- Incomplete Puzzle -->
            <div class="research-puzzle">
                <div class="puzzle-title">DIMENSIONAL FRAGMENT ANALYSIS</div>
                <div class="incomplete-puzzle-grid">
                    <div class="research-piece filled">1</div>
                    <div class="research-piece filled">2</div>
                    <div class="research-piece filled">3</div>
                    <div class="research-piece filled">4</div>
                    <div class="research-piece missing">?</div>
                    <div class="research-piece filled">6</div>
                    <div class="research-piece filled">7</div>
                    <div class="research-piece filled">8</div>
                    <div class="research-piece filled">9</div>
                </div>
                <div class="puzzle-status">
                    <span id="herta-puzzle-status">Fragment 5 missing - Enter dimension to retrieve</span>
                </div>
            </div>
        </div>

        <!-- Dimension Portal Overlay -->
        <div id="dimension-space" class="dimension-space" style="display: none;">
            <button id="dimension-back-btn" class="dimension-back-btn">‚Üê Exit Dimension</button>
            
            <div class="dimension-title">Dimensional Rift</div>
            <div class="dimension-message">Find the missing fragment among the chaos...</div>
            
            <!-- Lots of floating objects -->
            <div class="floating-object" style="top: 10%; left: 15%;">üì¶</div>
            <div class="floating-object" style="top: 15%; left: 45%;">‚≠ê</div>
            <div class="floating-object" style="top: 20%; right: 20%;">üîÆ</div>
            <div class="floating-object" style="top: 25%; left: 70%;">üíé</div>
            <div class="floating-object" style="top: 35%; left: 10%;">üåÄ</div>
            <div class="floating-object" style="top: 40%; right: 15%;">‚öôÔ∏è</div>
            <div class="floating-object" style="top: 45%; left: 55%;">üéØ</div>
            <div class="floating-object" style="top: 50%; left: 25%;">üî∑</div>
            <div class="floating-object" style="top: 55%; right: 40%;">‚ú®</div>
            <div class="floating-object" style="top: 60%; left: 80%;">üåü</div>
            <div class="floating-object" style="top: 65%; left: 35%;">üí´</div>
            <div class="floating-object" style="top: 70%; right: 25%;">üî∂</div>
            <div class="floating-object" style="top: 75%; left: 60%;">üé≤</div>
            <div class="floating-object" style="top: 80%; left: 20%;">üß©</div>
            <div class="floating-object" style="top: 85%; right: 50%;">üé®</div>
            
            <!-- The actual missing piece disguised as an object -->
            <div id="missing-piece" class="floating-object hidden-piece" style="top: 42%; left: 38%;">üî∏</div>
            
            <!-- More objects -->
            <div class="floating-object" style="top: 12%; right: 35%;">üî∫</div>
            <div class="floating-object" style="top: 30%; left: 5%;">üîª</div>
            <div class="floating-object" style="top: 48%; right: 8%;">‚¨°</div>
            <div class="floating-object" style="top: 68%; left: 12%;">‚¨¢</div>
            <div class="floating-object" style="top: 78%; right: 18%;">‚óÜ</div>
        </div>

        <div class="portal-ui">
            <div id="herta-label" class="mini-label">
                Advanced research facility of the Genius Society.
            </div>
        </div>
    </div>

    <!-- Luofu Sanctum portal (nature/autumn theme) -->
    <div id="luofu-portal" class="planet-portal luofu-sanctum" style="display: none;">
        <button id="luofu-back-planets" class="portal-back-icon" aria-label="Back to planet selection">
            ‚¨Ö
        </button>

        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <!-- Bamboo silhouettes on sides -->
        <div class="bamboo-forest">
            <div class="bamboo-stalk left" style="left: 5%; height: 85%;"></div>
            <div class="bamboo-stalk left" style="left: 8%; height: 75%;"></div>
            <div class="bamboo-stalk left" style="left: 12%; height: 90%;"></div>
            <div class="bamboo-stalk right" style="right: 5%; height: 80%;"></div>
            <div class="bamboo-stalk right" style="right: 9%; height: 88%;"></div>
            <div class="bamboo-stalk right" style="right: 13%; height: 78%;"></div>
        </div>

        <!-- Fireflies in background -->
        <div class="fireflies">
            <div class="firefly" style="top: 15%; left: 20%;"></div>
            <div class="firefly" style="top: 25%; left: 35%;"></div>
            <div class="firefly" style="top: 20%; right: 25%;"></div>
            <div class="firefly" style="top: 35%; right: 15%;"></div>
            <div class="firefly" style="top: 45%; left: 18%;"></div>
            <div class="firefly" style="top: 55%; right: 22%;"></div>
            <div class="firefly" style="top: 65%; left: 30%;"></div>
            <div class="firefly" style="top: 70%; right: 35%;"></div>
            <div class="firefly" style="top: 80%; left: 25%;"></div>
            <div class="firefly" style="top: 75%; right: 28%;"></div>
            <div class="firefly" style="top: 12%; left: 45%;"></div>
            <div class="firefly" style="top: 28%; right: 40%;"></div>
            <div class="firefly" style="top: 38%; left: 8%;"></div>
            <div class="firefly" style="top: 42%; right: 8%;"></div>
            <div class="firefly" style="top: 52%; left: 42%;"></div>
            <div class="firefly" style="top: 58%; right: 48%;"></div>
            <div class="firefly" style="top: 68%; left: 15%;"></div>
            <div class="firefly" style="top: 72%; right: 18%;"></div>
            <div class="firefly" style="top: 82%; left: 38%;"></div>
            <div class="firefly" style="top: 85%; right: 42%;"></div>
        </div>

        <!-- Flowing river -->
        <div class="sacred-river">
            <div class="river-flow"></div>
            <div class="river-shimmer"></div>
        </div>

        <!-- Swimming koi fish -->
        <div class="koi-fish-container">
            <div class="koi-fish" style="top: 48%;">
                <div class="koi-body"></div>
                <div class="koi-tail"></div>
            </div>
            <div class="koi-fish" style="top: 52%;">
                <div class="koi-body orange"></div>
                <div class="koi-tail orange"></div>
            </div>
            <div class="koi-fish" style="top: 56%;">
                <div class="koi-body gold"></div>
                <div class="koi-tail gold"></div>
            </div>
        </div>

        <!-- Nature scene -->
        <div class="luofu-content">
            <div class="luofu-title">Luofu Sanctum</div>
            <div class="luofu-subtitle">Sacred River of Memories</div>

            <div class="luofu-message">
                Step across the lotus flowers in the sacred river.<br/>
                Remember the sequence to reach enlightenment.
            </div>
        </div>

        <!-- Lotus Flower Memory Game -->
        <div class="lotus-game">
                <div class="game-title">Sacred Lotus Path</div>
                <div class="game-instructions">Watch the lotus bloom, then repeat the pattern!</div>
                
                <div class="lotus-flowers">
                    <div class="lotus-flower" data-stone="1">
                        <div class="lotus-petals">
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                        </div>
                        <div class="lotus-center"></div>
                        <div class="lotus-ripple"></div>
                    </div>
                    <div class="lotus-flower" data-stone="2">
                        <div class="lotus-petals">
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                        </div>
                        <div class="lotus-center"></div>
                        <div class="lotus-ripple"></div>
                    </div>
                    <div class="lotus-flower" data-stone="3">
                        <div class="lotus-petals">
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                        </div>
                        <div class="lotus-center"></div>
                        <div class="lotus-ripple"></div>
                    </div>
                    <div class="lotus-flower" data-stone="4">
                        <div class="lotus-petals">
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                        </div>
                        <div class="lotus-center"></div>
                        <div class="lotus-ripple"></div>
                    </div>
                    <div class="lotus-flower" data-stone="5">
                        <div class="lotus-petals">
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                        </div>
                        <div class="lotus-center"></div>
                        <div class="lotus-ripple"></div>
                    </div>
                    <div class="lotus-flower" data-stone="6">
                        <div class="lotus-petals">
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                            <div class="petal"></div>
                        </div>
                        <div class="lotus-center"></div>
                        <div class="lotus-ripple"></div>
                    </div>
                </div>

            <button id="start-crossing" class="start-btn">Begin Journey</button>
            <div id="stone-feedback" class="stone-feedback"></div>
            <div class="stone-progress">
                Round: <span id="stone-round">1</span> / 3
            </div>
        </div>

        <div class="portal-ui">
            <div id="luofu-label" class="mini-label">
                Welcome to the peaceful Luofu Sanctum.
            </div>
        </div>
    </div>

    <!-- Stellaron portal (villain/dark theme) -->
    <div id="stellaron-portal" class="planet-portal stellaron-dark" style="display: none;">
        <button id="stellaron-back-planets" class="portal-back-icon" aria-label="Back to planet selection">
            ‚¨Ö
        </button>

        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <!-- Electric reality cracks -->
        <svg class="reality-cracks" width="100%" height="100%">
            <line x1="10%" y1="20%" x2="30%" y2="15%" class="crack-line" />
            <line x1="30%" y1="15%" x2="45%" y2="25%" class="crack-line" />
            <line x1="45%" y1="25%" x2="55%" y2="18%" class="crack-line" />
            <line x1="70%" y1="30%" x2="85%" y2="25%" class="crack-line" />
            <line x1="85%" y1="25%" x2="90%" y2="35%" class="crack-line" />
            <line x1="15%" y1="60%" x2="25%" y2="70%" class="crack-line" />
            <line x1="25%" y1="70%" x2="35%" y2="65%" class="crack-line" />
            <line x1="60%" y1="75%" x2="75%" y2="80%" class="crack-line" />
            <line x1="75%" y1="80%" x2="85%" y2="70%" class="crack-line" />
            <line x1="40%" y1="50%" x2="50%" y2="55%" class="crack-line" />
            <line x1="50%" y1="55%" x2="60%" y2="50%" class="crack-line" />
        </svg>

        <!-- Smoke/fog layers -->
        <div class="corruption-smoke">
            <div class="smoke-layer"></div>
            <div class="smoke-layer"></div>
            <div class="smoke-layer"></div>
            <div class="smoke-layer"></div>
        </div>

        <!-- Dark villain atmosphere -->
        <div class="stellaron-content">
            <div class="stellaron-title glitch-text">STELLARON</div>
            <div class="stellaron-subtitle glitch-text">Corrupted Core</div>
            
            <div class="stellaron-message">
                Escape the shadow maze before the darkness consumes you.
                <br/>
                Only a small light guides your way...
            </div>
        </div>

            <!-- Shadow Maze Game -->
            <div class="shadow-maze-game">
                <div class="maze-title">SHADOW MAZE</div>
                <button id="start-maze" class="maze-start-btn">Enter the Darkness</button>
                
                <div id="maze-container" class="maze-container" style="display: none;">
                    <button id="exit-maze" class="maze-exit-btn">‚Üê Exit Maze</button>
                    <canvas id="maze-canvas" width="500" height="500"></canvas>
                    <div id="maze-light" class="maze-light"></div>
                    <div id="maze-status" class="maze-status">Find the exit...</div>
                </div>
            </div>
        </div>

        <div class="portal-ui">
            <div id="stellaron-label" class="mini-label" style="display: none;">
                Beware the corrupted Stellaron...
            </div>
        </div>
    </div>

    <!-- Penacony portal -->
    <div id="penacony-portal" class="planet-portal penacony-casino" style="display: none;">
        <!-- Back to planet selection: top-left revert icon -->
        <button id="penacony-back-planets" class="portal-back-icon" aria-label="Back to planet selection">
            ‚¨Ö
        </button>

        <div class="portal-backdrop">
            <div class="portal-core"></div>
            <div class="portal-ring outer"></div>
            <div class="portal-ring inner"></div>
        </div>

        <!-- Velvet curtains -->
        <div class="velvet-curtains">
            <div class="curtain left"></div>
            <div class="curtain right"></div>
        </div>

        <!-- Chandelier light rays -->
        <div class="chandelier-light">
            <div class="light-ray"></div>
            <div class="light-ray"></div>
            <div class="light-ray"></div>
        </div>

        <!-- Carnival string lights -->
        <div class="string-lights">
            <div class="light-bulb"></div>
            <div class="light-bulb"></div>
            <div class="light-bulb"></div>
            <div class="light-bulb"></div>
            <div class="light-bulb"></div>
            <div class="light-bulb"></div>
            <div class="light-bulb"></div>
            <div class="light-bulb"></div>
        </div>

        <!-- Floating cosmic poker chips -->
        <div class="cosmic-chips">
            <div class="poker-chip chip-1">
                <div class="chip-inner">ü™ê</div>
            </div>
            <div class="poker-chip chip-2">
                <div class="chip-inner">üåô</div>
            </div>
            <div class="poker-chip chip-3">
                <div class="chip-inner">‚≠ê</div>
            </div>
            <div class="poker-chip chip-4">
                <div class="chip-inner">üí´</div>
            </div>
            <div class="poker-chip chip-5">
                <div class="chip-inner">‚ú®</div>
            </div>
        </div>

        <!-- Gold confetti rain -->
        <div class="gold-confetti">
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
            <div class="confetti"></div>
        </div>

        <div class="penacony-content">
            <div class="penacony-title">Penacony - Dream Casino</div>
            
            <!-- Slot Machine -->
            <div class="slot-machine">
                <div class="slot-machine-top"></div>
                <div class="slot-machine-body">
                    <div class="slot-display">
                        <div id="slot-equation" class="slot-equation">Press Start</div>
                    </div>
                    <div class="slot-lever"></div>
                </div>
                <button id="slot-start-btn" class="slot-start-btn">START</button>
            </div>

            <!-- Coin Stack (right side) -->
            <div class="coin-stack">
                <div class="coin-label">Select Answer:</div>
                <div id="coin-container" class="coin-container">
                    <!-- Coins will be generated by JavaScript -->
                </div>
            </div>

            <div id="penacony-feedback" class="penacony-feedback"></div>

            <!-- Ticket Shards Collection -->
            <div class="ticket-shards-container">
                <div class="ticket-shards-label">Ticket Shards:</div>
                <div class="ticket-shards">
                    <div id="shard-1" class="ticket-shard locked">
                        <div class="shard-number">1</div>
                    </div>
                    <div id="shard-2" class="ticket-shard locked">
                        <div class="shard-number">2</div>
                    </div>
                    <div id="shard-3" class="ticket-shard locked">
                        <div class="shard-number">3</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="portal-ui">
            <div id="penacony-label" class="mini-label">
                Test your luck and wit in the Dream Casino.
            </div>
        </div>
    </div>

    <!-- Terminus portal (final lobby with door) -->
    <div id="terminus-portal" class="planet-portal terminus-lobby" style="display: none;">
        <button id="terminus-back-planets" class="portal-back-icon" aria-label="Back to planet selection">
            ‚¨Ö
        </button>

        <!-- Lobby atmosphere -->
        <div class="terminus-content">
            <div class="terminus-title">TERMINUS</div>
            <div class="terminus-subtitle">The Final Threshold</div>

            <!-- Elegant lobby room -->
            <div class="lobby-room">
                <!-- Floor tiles -->
                <div class="lobby-floor"></div>
                
                <!-- Walls with ambient lighting -->
                <div class="lobby-walls">
                    <div class="wall-light left"></div>
                    <div class="wall-light right"></div>
                </div>

                <!-- The mysterious door -->
                <div class="mysterious-door" id="terminus-door">
                    <div class="door-frame">
                        <div class="door-panel">
                            <div class="door-handle"></div>
                            <div class="door-glow"></div>
                        </div>
                        <div class="door-inscription">Click to unlock...</div>
                    </div>
                </div>

                <!-- Key Puzzle Overlay (hidden until door clicked) -->
                <div id="key-puzzle-overlay" class="key-puzzle-overlay" style="display: none;">
                    <div class="key-puzzle-panel">
                        <div class="puzzle-header">
                            <h2>Unlock the Final Door</h2>
                            <p>Drag each key to its matching keyhole</p>
                            <button id="close-key-puzzle" class="close-puzzle-btn">‚úï</button>
                        </div>

                        <div class="puzzle-content">
                            <!-- Keyholes on the left -->
                            <div class="keyholes-container">
                                <div class="keyhole" data-planet="belobog">
                                    <div class="keyhole-icon">üç≠</div>
                                    <div class="keyhole-label">Belobog</div>
                                    <div class="keyhole-slot"></div>
                                </div>
                                <div class="keyhole" data-planet="xianzhou">
                                    <div class="keyhole-icon">üåô</div>
                                    <div class="keyhole-label">Xianzhou</div>
                                    <div class="keyhole-slot"></div>
                                </div>
                                <div class="keyhole" data-planet="penacony">
                                    <div class="keyhole-icon">üé∞</div>
                                    <div class="keyhole-label">Penacony</div>
                                    <div class="keyhole-slot"></div>
                                </div>
                                <div class="keyhole" data-planet="jarilo">
                                    <div class="keyhole-icon">‚ùÑÔ∏è</div>
                                    <div class="keyhole-label">Jarilo-VI</div>
                                    <div class="keyhole-slot"></div>
                                </div>
                                <div class="keyhole" data-planet="herta">
                                    <div class="keyhole-icon">üî¨</div>
                                    <div class="keyhole-label">Herta</div>
                                    <div class="keyhole-slot"></div>
                                </div>
                                <div class="keyhole" data-planet="luofu">
                                    <div class="keyhole-icon">ü™∑</div>
                                    <div class="keyhole-label">Luofu</div>
                                    <div class="keyhole-slot"></div>
                                </div>
                                <div class="keyhole" data-planet="stellaron">
                                    <div class="keyhole-icon">‚ö°</div>
                                    <div class="keyhole-label">Stellaron</div>
                                    <div class="keyhole-slot"></div>
                                </div>
                            </div>

                            <!-- Keys on the right -->
                            <div class="keys-container" id="keys-container">
                                <!-- Keys will be dynamically added here based on collected keys -->
                            </div>
                        </div>

                        <div class="puzzle-footer">
                            <div id="key-count">Keys Collected: <span id="key-count-num">0</span>/7</div>
                        </div>
                    </div>
                </div>

                <!-- Ambient particles -->
                <div class="lobby-particles">
                    <div class="light-particle"></div>
                    <div class="light-particle"></div>
                    <div class="light-particle"></div>
                    <div class="light-particle"></div>
                </div>
            </div>

            <div class="terminus-message">
                You stand before the final door.<br/>
                All your trials have led to this moment.
            </div>
        </div>

        <div class="portal-ui">
            <div id="terminus-label" class="mini-label">
                The journey's end awaits beyond this threshold.
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
